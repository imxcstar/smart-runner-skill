# SmartRunner ğŸ¤–

**SmartRunner** æ˜¯ä¸€ä¸ªä¸º AI åŠ©æ‰‹ï¼ˆå¦‚ OpenClawï¼‰è®¾è®¡çš„é•¿è€—æ—¶ä»»åŠ¡ç›‘æ§å™¨ã€‚å®ƒèƒ½åƒäººç±»ä¸€æ ·è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼Œåœ¨ä»»åŠ¡å¡ä½æˆ–éœ€è¦ç”¨æˆ·è¾“å…¥æ—¶è‡ªåŠ¨å”¤é†’ AI ä»‹å…¥ï¼Œå¹¶æä¾›å®‰å…¨çš„è¿œç¨‹è¾“å…¥é€šé“ã€‚

---

## ğŸ‘¤ ç”¨æˆ·æ‰‹å†Œ (User Guide)

### ğŸŒŸ æ ¸å¿ƒç‰¹æ€§
-   **æ™ºèƒ½å”¤é†’**ï¼šåœ¨ç¨‹åºç­‰å¾…è¾“å…¥ (`IO_WAIT`) æˆ–é•¿æ—¶é—´æ— å“åº” (`STALL`) æ—¶è‡ªåŠ¨å«é†’ AIã€‚
-   **å¿ƒè·³åŒæ­¥**ï¼šæ¯ 5 åˆ†é’Ÿæ±‡æŠ¥ä¸€æ¬¡è¿›åº¦ã€‚
-   **è¾“å…¥é€šé“**ï¼šAI å¯ä»¥å¼‚æ­¥æ³¨å…¥æŒ‡ä»¤ï¼ˆå›è½¦ã€Ctrl+Cã€å¯†ç ï¼‰ã€‚

### ğŸš€ å¦‚ä½•é…åˆ AI ä½¿ç”¨ (OpenClaw / OpenCode)
SmartRunner çš„æœ€å¤§å¨åŠ›åœ¨äº**å…¨è‡ªåŠ¨åŒ–è¿ç»´**ã€‚

#### 1. å¯åŠ¨ç›‘æ§ä»»åŠ¡
å½“ä½ éœ€è¦æ‰§è¡Œ `npm install`ã€`docker build` æˆ–é•¿æ—¶é—´çš„æ•°æ®åº“è¿ç§»æ—¶ï¼Œä¸è¦ç›´æ¥è¿è¡Œï¼Œè€Œæ˜¯è®© AI åŠ©æ‰‹ä½¿ç”¨ SmartRunner åŒ…è£¹ï¼š
```bash
python3 runner.py \
  --cmd "npm install" \
  --name "V2EX_DEPS_INSTALL" \
  --payload "æ­£åœ¨å®‰è£… V2EX é¡¹ç›®ä¾èµ–ã€‚å¦‚æœé‡åˆ°æƒé™æŠ¥é”™è¯· sudoï¼Œé‡åˆ°ç‰ˆæœ¬å†²çªè¯·é€‰æ‹©æœ€æ–°ç‰ˆã€‚"
```

#### 2. å®ç°è‡ªåŠ¨å®‰è£…ä¸ä¿®å¤
ä¸€æ—¦ SmartRunner æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œå®ƒä¼šè§¦å‘ OpenClaw çš„ **Cron äº‹ä»¶**ã€‚ä½ çš„ AI åŠ©æ‰‹ï¼ˆOpenCode/Claudeï¼‰å°†æ”¶åˆ°é€šçŸ¥å¹¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
1.  **è‡ªåŠ¨è¯Šæ–­**ï¼šè¯»å– `.runner/output.log` æŸ¥çœ‹æŠ¥é”™åŸå› ã€‚
2.  **è‡ªåŠ¨ä¿®å¤**ï¼š
    -   å¦‚æœéœ€è¦è¾“å…¥ `Y`ï¼Œå®ƒä¼šæ‰§è¡Œ `echo "Y" > .runner/input.pipe`ã€‚
    -   å¦‚æœéœ€è¦å®‰è£…ç¼ºå¤±çš„ç³»ç»ŸåŒ…ï¼Œå®ƒä¼šæ‰“å¼€ä¸€ä¸ªå­ session å¤„ç†ï¼Œå®Œæˆåå†å›åˆ°å½“å‰ä»»åŠ¡ã€‚
3.  **è‡ªåŠ¨æ¢å¤**ï¼šAI å¤„ç†å®Œåï¼Œä¼šå°† `{"state": "AI_DONE"}` å†™å…¥ `.runner/status.json`ï¼ŒSmartRunner éšå³æ¢å¤ç›‘æ§ã€‚

---

## ğŸ¤– AI å¼€å‘è€…æ‰‹å†Œ (Agent Instruction)

> **FOR AI ASSISTANTS**: Read this section to understand how to operate SmartRunner.

### 1. éƒ¨ç½²ä¸é…ç½® (Setup)
- **ä¾èµ–**ï¼šä»…éœ€æ ‡å‡† Python 3 ç¯å¢ƒã€‚
- **æƒé™**ï¼šç¡®ä¿æœ‰æƒé™åœ¨å½“å‰å·¥ä½œç›®å½•åˆ›å»º `.runner/` éšè—æ–‡ä»¶å¤¹åŠå…¶å†…éƒ¨çš„å‘½åç®¡é“ (FIFO)ã€‚
- **OpenClaw é…ç½®**ï¼šSmartRunner ä¾èµ– `openclaw cron` å‘½ä»¤è¿›è¡Œä¸»åŠ¨å”¤é†’ã€‚ç¡®ä¿ `openclaw` å¯æ‰§è¡Œæ–‡ä»¶åœ¨ PATH ä¸­ã€‚

### 2. äº¤äº’åè®® (Interaction Protocol)
å½“ SmartRunner å”¤é†’ä½ æ—¶ï¼Œä½ å¿…é¡»éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1.  **ç¡®è®¤çŠ¶æ€ (Read Status)**: 
    - è¿è¡Œ `read .runner/status.json`
    - æ£€æŸ¥ `reason` (æ˜¯ `IO_WAIT`, `STALL` è¿˜æ˜¯ `HEARTBEAT`)ã€‚
2.  **è·å–è¯­å¢ƒ (Get Context)**:
    - è¿è¡Œ `tail -n 30 .runner/output.log`
    - åˆ†ææœ€åå‡ è¡Œæ˜¯å¦æœ‰è¾“å…¥æç¤ºç¬¦ï¼ˆå¦‚ `[y/N]`ï¼‰æˆ– Error Tracebackã€‚
3.  **å‘é€è¾“å…¥ (Inject Input)**:
    - **å¸¸è§„è¾“å…¥**: `exec 'echo "your_text" > .runner/input.pipe'`
    - **å›è½¦ (Enter)**: `exec 'printf "
" > .runner/input.pipe'`
    - **é€€å‡º (Ctrl+C)**: `exec 'printf "\x03" > .runner/input.pipe'`
4.  **é‡Šæ”¾æŒ‚èµ· (Resume)**:
    - **å…³é”®**ï¼šä½ å¿…é¡»å†™å…¥ç‰¹å®šçš„ JSON çŠ¶æ€æ¥å‘Šè¯‰ç›‘æ§è¿›ç¨‹ä½ å·²ç»å¤„ç†å®Œæ¯•ã€‚
    - è¿è¡Œ `write .runner/status.json '{"state": "AI_DONE"}'`
    - *æ³¨æ„ï¼šå¦‚æœä¸æ‰§è¡Œæ­¤æ­¥éª¤ï¼ŒSmartRunner å°†ä¿æŒæš‚åœçŠ¶æ€ï¼Œä¸ä¼šç»§ç»­æ•è·æ–°è¾“å‡ºã€‚*

### 3. æ³¨æ„äº‹é¡¹
- é¿å…åœ¨ `input.pipe` ä¸­å‘é€å¤§æ®µæ–‡æœ¬ï¼Œä¼˜å…ˆå‘é€ç²¾ç®€çš„æŒ‡ä»¤ã€‚
- å¦‚æœå†³å®šæ€æ­»å­è¿›ç¨‹ï¼Œè¯·ä½¿ç”¨ `.runner/status.json` ä¸­çš„ `child_pid`ã€‚

---

## âš–ï¸ å¼€æºåè®®
æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) åè®®ã€‚
